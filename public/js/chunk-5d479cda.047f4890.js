(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d479cda"],{"0a49":function(t,e,a){var s=a("9b43"),o=a("626a"),i=a("4bf8"),r=a("9def"),n=a("cd1c");t.exports=function(t,e){var a=1==t,c=2==t,l=3==t,d=4==t,u=6==t,p=5==t||u,m=e||n;return function(e,n,b){for(var f,v,h=i(e),y=o(h),j=s(n,b,3),g=r(y.length),_=0,C=a?m(e,g):c?m(e,0):void 0;g>_;_++)if((p||_ in y)&&(f=y[_],v=j(f,_,h),t))if(a)C[_]=v;else if(v)switch(t){case 3:return!0;case 5:return f;case 6:return _;case 2:C.push(f)}else if(d)return!1;return u?-1:l||d?d:C}}},1169:function(t,e,a){var s=a("2d95");t.exports=Array.isArray||function(t){return"Array"==s(t)}},"2f0f":function(t,e,a){"use strict";var s=a("64cb"),o=a.n(s);o.a},"372d":function(t,e,a){},"386b":function(t,e,a){var s=a("5ca1"),o=a("79e5"),i=a("be13"),r=/"/g,n=function(t,e,a,s){var o=String(i(t)),n="<"+e;return""!==a&&(n+=" "+a+'="'+String(s).replace(r,"&quot;")+'"'),n+">"+o+"</"+e+">"};t.exports=function(t,e){var a={};a[t]=e(n),s(s.P+s.F*o(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",a)}},"43ed":function(t,e,a){"use strict";var s=a("372d"),o=a.n(s);o.a},"504c":function(t,e,a){var s=a("9e1e"),o=a("0d58"),i=a("6821"),r=a("52a7").f;t.exports=function(t){return function(e){var a,n=i(e),c=o(n),l=c.length,d=0,u=[];while(l>d)a=c[d++],s&&!r.call(n,a)||u.push(t?[a,n[a]]:n[a]);return u}}},5065:function(t,e,a){},"64cb":function(t,e,a){},7514:function(t,e,a){"use strict";var s=a("5ca1"),o=a("0a49")(5),i="find",r=!0;i in[]&&Array(1)[i](function(){r=!1}),s(s.P+s.F*r,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(i)},8615:function(t,e,a){var s=a("5ca1"),o=a("504c")(!1);s(s.S,"Object",{values:function(t){return o(t)}})},"871d":function(t,e,a){"use strict";var s=a("5065"),o=a.n(s);o.a},cd1c:function(t,e,a){var s=a("e853");t.exports=function(t,e){return new(s(t))(e)}},e853:function(t,e,a){var s=a("d3f4"),o=a("1169"),i=a("2b4c")("species");t.exports=function(t){var e;return o(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!o(e.prototype)||(e=void 0),s(e)&&(e=e[i],null===e&&(e=void 0))),void 0===e?Array:e}},f386:function(t,e,a){"use strict";a("386b")("small",function(t){return function(){return t(this,"small","","")}})},fecd:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lk-object"},[a("l-k-yandex-map",{attrs:{address:t.yandexSearchAddress,object:t.object},on:{"set-coordinates":t.setCoordinate,"reset-search-address":function(e){t.yandexSearchAddress=""}}}),a("div",{staticClass:"pt-5 pb-5 row shadow",style:{width:t.favoritesOffsetLeft,zIndex:1}},[a("form",{staticClass:"col",on:{submit:function(e){return e.preventDefault(),t.saveObject(e)}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col col-8 offset-2"},[a("h5",{staticClass:"text-primary mb-5 text-center"},[t._v(t._s(t.head+" объекта"))]),a("div",{staticClass:"table-borderless"},[a("table",{staticClass:"table table-sm"},[a("tbody",[a("tr",[a("td",{staticClass:"pr-4",attrs:{width:"50%",colspan:"2"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.object.type,expression:"object.type"}],staticClass:"custom-select border",attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.object,"type",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("Категория")]),a("option",{attrs:{value:"ZU"}},[t._v("Земельный участок")]),a("option",{attrs:{value:"Invest"}},[t._v("Инвестобъект")])])]),a("td",{attrs:{width:"50%",colspan:"2"}})]),""!==t.object.type?[a("tr",[a("td",{staticClass:"pr-4",attrs:{width:"50%",colspan:"2"}},["ZU"===t.object.type?a("select",{directives:[{name:"model",rawName:"v-model",value:t.object.ZUType,expression:"object.ZUType"}],staticClass:"custom-select border",attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.object,"ZUType",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("Тип объекта")]),a("option",{attrs:{value:"ЗУ"}},[t._v("Земельные участки (ЗУ)")]),a("option",{attrs:{value:"ОКС"}},[t._v("ОКС под реконструкцию")])]):t._e(),"Invest"===t.object.type?a("select",{directives:[{name:"model",rawName:"v-model",value:t.object.buildingType,expression:"object.buildingType"}],staticClass:"custom-select border",attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.object,"buildingType",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("Тип объекта")]),t._l(t.buildingTypes,function(e,s){return a("option",{key:s,domProps:{value:e}},[t._v("\n                          "+t._s(e.full)+"\n                      ")])})],2):t._e()]),a("td",{attrs:{width:"50%",colspan:"2"}})]),a("tr",[a("td",{attrs:{width:"25%"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.object.district,expression:"object.district"}],staticClass:"custom-select border",attrs:{required:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.object,"district",e.target.multiple?a:a[0])},t.setLocation]}},[a("option",{attrs:{value:""}},[t._v("Субъект")]),t._l(t.districts,function(e,s){return a("option",{key:s,domProps:{value:e}},[t._v("\n                          "+t._s(e)+"\n                        ")])})],2)]),a("td",{staticClass:"address",attrs:{colspan:"3"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.address,expression:"object.address"}],staticClass:"form-control text-center border",attrs:{type:"text",placeholder:"Адрес",required:"",title:"Адрес"},domProps:{value:t.object.address},on:{input:function(e){e.target.composing||t.$set(t.object,"address",e.target.value)}}}),a("a",{attrs:{href:""},on:{click:function(e){e.preventDefault(),t.yandexSearchAddress=t.object.address}}},[t._v("\n                      Найти на карте >>>\n                    ")])])]),a("tr",[a("td",{staticClass:"pr-4",class:{borderRight:"ZU"===t.object.type},attrs:{width:"50%",colspan:"2"}},["ZU"===t.object.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.kadastrNumberZU,expression:"object.kadastrNumberZU"}],staticClass:"form-control border",attrs:{type:"text",placeholder:"Кадастровый номер ЗУ",required:"",title:"Кадастровый номер ЗУ"},domProps:{value:t.object.kadastrNumberZU},on:{input:function(e){e.target.composing||t.$set(t.object,"kadastrNumberZU",e.target.value)}}}):t._e(),"Invest"===t.object.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.buildingName,expression:"object.buildingName"}],staticClass:"form-control border",attrs:{type:"text",placeholder:"Название",required:"",title:"Название"},domProps:{value:t.object.buildingName},on:{input:function(e){e.target.composing||t.$set(t.object,"buildingName",e.target.value)}}}):t._e()]),a("td",{staticClass:"pl-4",attrs:{width:"50%",colspan:"2"}},["ZU"===t.object.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.kadastrNumberOKS,expression:"object.kadastrNumberOKS"}],staticClass:"form-control border",attrs:{type:"text",placeholder:"Кадастровый номер ОКС",required:"ОКС"===t.object.ZUType,title:"Кадастровый номер ОКС"},domProps:{value:t.object.kadastrNumberOKS},on:{input:function(e){e.target.composing||t.$set(t.object,"kadastrNumberOKS",e.target.value)}}}):t._e()])]),a("tr",[a("td",{staticClass:"pr-4",class:{borderRight:"ZU"===t.object.type},attrs:{width:"50%",colspan:"2"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.groundS,expression:"object.groundS"}],staticClass:"form-control border",attrs:{type:"text",placeholder:"Площадь ЗУ, Га",required:"",title:"Площадь ЗУ, Га"},domProps:{value:t.object.groundS},on:{input:function(e){e.target.composing||t.$set(t.object,"groundS",e.target.value)}}})]),a("td",{staticClass:"pl-4",attrs:{width:"50%",colspan:"2"}},["ZU"===t.object.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.areaS,expression:"object.areaS"}],staticClass:"form-control border",attrs:{type:"text",placeholder:"Площадь ОКС, кв.м.",required:"ОКС"===t.object.ZUType,title:"Площадь ОКС, кв.м."},domProps:{value:t.object.areaS},on:{input:function(e){e.target.composing||t.$set(t.object,"areaS",e.target.value)}}}):t._e()])]),a("tr",[a("td",{staticClass:"pr-4",class:{borderRight:"ZU"===t.object.type},attrs:{width:"50%",colspan:"2"}},["ZU"===t.object.type?a("select",{directives:[{name:"model",rawName:"v-model",value:t.object.purposeZU,expression:"object.purposeZU"}],staticClass:"custom-select border",attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.object,"purposeZU",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("Назначение ЗУ")]),a("option",{attrs:{value:"Жилое"}},[t._v("Жилое")]),a("option",{attrs:{value:"Нежилое"}},[t._v("Нежилое")])]):t._e(),"Invest"===t.object.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.areaS,expression:"object.areaS"}],staticClass:"form-control border",attrs:{type:"text",placeholder:"Площадь здания, кв.м.",required:"",title:"Площадь здания, кв.м."},domProps:{value:t.object.areaS},on:{input:function(e){e.target.composing||t.$set(t.object,"areaS",e.target.value)}}}):t._e()]),a("td",{staticClass:"pl-4",attrs:{width:"50%",colspan:"2"}},["ZU"===t.object.type?a("select",{directives:[{name:"model",rawName:"v-model",value:t.object.purposeOKS,expression:"object.purposeOKS"}],staticClass:"custom-select border",attrs:{required:"ОКС"===t.object.ZUType},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.object,"purposeOKS",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("Назначение ОКС")]),a("option",{attrs:{value:"Жилое"}},[t._v("Жилое")]),a("option",{attrs:{value:"Нежилое"}},[t._v("Нежилое")]),a("option",{attrs:{value:"Апартаменты"}},[t._v("Апартаменты")])]):t._e()])]),a("tr",[a("td",{staticClass:"pr-4",attrs:{width:"50%",colspan:"2"}},["ZU"===t.object.type?a("select",{directives:[{name:"model",rawName:"v-model",value:t.object.groundPlan,expression:"object.groundPlan"}],staticClass:"custom-select border",attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.object,"groundPlan",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("Наличие ГПЗУ")]),a("option",{domProps:{value:!0}},[t._v("Есть")]),a("option",{domProps:{value:!1}},[t._v("Нет")])]):t._e(),"Invest"===t.object.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.GAP,expression:"object.GAP"}],staticClass:"form-control border",attrs:{type:"text",placeholder:"ГАП",required:"",title:"ГАП"},domProps:{value:t.object.GAP},on:{input:function(e){e.target.composing||t.$set(t.object,"GAP",e.target.value)}}}):t._e()]),a("td",{staticClass:"pl-4",attrs:{width:"50%",colspan:"2"}},["Invest"===t.object.type?a("select",{directives:[{name:"model",rawName:"v-model",value:t.object.GAPCurrency,expression:"object.GAPCurrency"}],staticClass:"custom-select border",staticStyle:{width:"7rem"},attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.object,"GAPCurrency",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("Валюта")]),a("option",{attrs:{value:"rouble"}},[t._v("руб.")]),a("option",{attrs:{value:"dollar"}},[t._v("долл.")]),a("option",{attrs:{value:"euro"}},[t._v("евро")])]):t._e()])]),"Invest"===t.object.type?a("tr",[a("td",{staticClass:"pr-4",attrs:{width:"50%",colspan:"2"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.caprate,expression:"object.caprate"}],staticClass:"form-control border",attrs:{type:"text",placeholder:"Caprate, %",required:"",title:"Caprate, %"},domProps:{value:t.object.caprate},on:{input:function(e){e.target.composing||t.$set(t.object,"caprate",e.target.value)}}})]),a("td",{staticClass:"pr-4",attrs:{width:"50%",colspan:"2"}})]):t._e(),a("tr",[a("td",{staticClass:"pr-4",attrs:{width:"50%",colspan:"2"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.cost,expression:"object.cost"}],staticClass:"form-control border",attrs:{type:"text",placeholder:"Стоимость",required:"",title:"Стоимость"},domProps:{value:t.object.cost},on:{input:function(e){e.target.composing||t.$set(t.object,"cost",e.target.value)}}})]),a("td",{staticClass:"pl-4 position-relative",attrs:{colspan:"2"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.object.costCurrency,expression:"object.costCurrency"}],staticClass:"custom-select border",staticStyle:{width:"7rem"},attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.object,"costCurrency",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("Валюта")]),a("option",{attrs:{value:"rouble"}},[t._v("руб.")]),a("option",{attrs:{value:"dollar"}},[t._v("долл.")]),a("option",{attrs:{value:"euro"}},[t._v("евро")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.responsible,expression:"object.responsible"}],staticClass:"form-control border responsible",attrs:{type:"text",placeholder:"Ответственный",required:"",title:"Ответственный"},domProps:{value:t.object.responsible},on:{input:function(e){e.target.composing||t.$set(t.object,"responsible",e.target.value)}}})])])]:t._e()],2)])])])]),""!==t.object.type?a("div",{staticClass:"row justify-content-center"},[a("div",{staticClass:"col col-10"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.object.description,expression:"object.description"}],staticClass:"form-control border",attrs:{cols:"30",rows:"10",placeholder:"Описание",title:"Описание",required:""},domProps:{value:t.object.description},on:{input:function(e){e.target.composing||t.$set(t.object,"description",e.target.value)}}})])]):t._e(),""!==t.object.type?a("div",{staticClass:"row justify-content-center mt-3"},[a("div",{staticClass:"col col-10"},[t.object.images?a("file-upload",{key:t.key,attrs:{type:"images",files:t.object.images,"object-type":t.object.type},on:{uploaded:t.fileUploaded,removed:t.fileRemoved,"add-caption":t.addCaption,"set-main-image":t.setMainImage}}):t._e()],1)]):t._e(),""!==t.object.type?a("div",{staticClass:"row justify-content-center mt-3"},[a("div",{staticClass:"col col-10"},[t.object.docs?a("file-upload",{key:t.key,attrs:{type:"docs",files:t.object.docs,"object-type":t.object.type},on:{uploaded:t.fileUploaded,removed:t.fileRemoved}}):t._e()],1)]):t._e(),""!==t.object.type?a("div",{staticClass:"row justify-content-center mt-3"},[a("div",{staticClass:"col col-auto mt-3"},[a("div",{staticClass:"custom-control custom-switch mb-1"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.only_auth,expression:"object.only_auth"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"onlyAuth",disabled:t.object.object_admins_only},domProps:{checked:Array.isArray(t.object.only_auth)?t._i(t.object.only_auth,null)>-1:t.object.only_auth},on:{change:function(e){var a=t.object.only_auth,s=e.target,o=!!s.checked;if(Array.isArray(a)){var i=null,r=t._i(a,i);s.checked?r<0&&t.$set(t.object,"only_auth",a.concat([i])):r>-1&&t.$set(t.object,"only_auth",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.object,"only_auth",o)}}}),a("label",{staticClass:"custom-control-label",attrs:{for:"onlyAuth"}},[t._v("\n                Ограничить доступ гостям\n              ")])]),a("div",{staticClass:"custom-control custom-switch mb-1"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.price_admins_only,expression:"object.price_admins_only"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"priceAdminsOnly",disabled:t.object.object_admins_only},domProps:{checked:Array.isArray(t.object.price_admins_only)?t._i(t.object.price_admins_only,null)>-1:t.object.price_admins_only},on:{change:function(e){var a=t.object.price_admins_only,s=e.target,o=!!s.checked;if(Array.isArray(a)){var i=null,r=t._i(a,i);s.checked?r<0&&t.$set(t.object,"price_admins_only",a.concat([i])):r>-1&&t.$set(t.object,"price_admins_only",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.object,"price_admins_only",o)}}}),a("label",{staticClass:"custom-control-label",attrs:{for:"priceAdminsOnly"}},[t._v("\n                Показывать цену только группе администратора\n              ")])]),a("div",{staticClass:"custom-control custom-switch mb-1"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.object.object_admins_only,expression:"object.object_admins_only"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"objectAdminsOnly"},domProps:{checked:Array.isArray(t.object.object_admins_only)?t._i(t.object.object_admins_only,null)>-1:t.object.object_admins_only},on:{change:[function(e){var a=t.object.object_admins_only,s=e.target,o=!!s.checked;if(Array.isArray(a)){var i=null,r=t._i(a,i);s.checked?r<0&&t.$set(t.object,"object_admins_only",a.concat([i])):r>-1&&t.$set(t.object,"object_admins_only",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.object,"object_admins_only",o)},t.syncScope]}}),a("label",{staticClass:"custom-control-label",attrs:{for:"objectAdminsOnly"}},[t._v("\n                Показывать объект только группе администратора\n              ")])])])]):t._e(),""!==t.object.type?a("div",{staticClass:"row justify-content-center mt-5"},[a("div",{staticClass:"col col-4"},[a("button",{staticClass:"btn btn-primary btn-block",attrs:{type:"submit",disabled:t.disabled}},[a("span",{class:{invisible:t.disabled}},[t._v("\n                "+t._s(t.buttonName)+"\n              ")]),a("span",{staticClass:"spinner-border text-white spinner spinner-border-sm",class:{invisible:!t.disabled},attrs:{role:"status"}},[a("span",{staticClass:"sr-only"},[t._v("Loading...")])])])])]):t._e()])])],1)},o=[],i=(a("8615"),a("6b54"),a("a481"),a("456d"),a("ac6a"),a("4917"),a("6762"),a("2fdb"),a("2b0e")),r=a("c988"),n=a("25be"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"border file-upload row pt-2 position-relative ml-0 mr-0"},["images"===t.type?t._l(t.allFiles,function(e,s){return a("div",{key:s,staticClass:"col col-auto mb-2"},[a("div",{staticClass:"row justify-content-center"},[a("div",{staticClass:"col col-auto"},[a("span",{staticClass:"position-relative d-inline-block image-wrapper"},[a("img",{staticClass:"img-thumbnail",attrs:{src:e.src}}),a("div",{staticClass:"image-bg bg-primary text-white"},[a("p",{staticClass:"mt-5 pl-2 pr-2 text-white text-break"},[t._v("\n                      "+t._s(e.original_filename?e.original_filename:e.filename)+"\n                  ")])]),a("button",{staticClass:"btn remove-image btn-outline-danger btn-sm border",attrs:{title:"cделать главным",type:"button"},on:{click:function(a){return t.removeFile(e,s)}}},[a("i",{staticClass:"fa fa-close"})]),"images"===t.type&&t.mainImage&&t.mainImage.toString()===s?a("button",{staticClass:"btn main-image btn-success btn-sm border",attrs:{title:"главное",type:"button"},on:{click:function(t){t.preventDefault()}}},[a("i",{staticClass:"fa fa-check"})]):t._e(),"images"===t.type&&e.uploaded&&t.mainImage!==s?a("button",{staticClass:"btn make-main-image btn-success btn-sm border",attrs:{title:"cделать главным",type:"button"},on:{click:function(e){return t.makeMain(s)}}},[a("i",{staticClass:"fa fa-check"})]):t._e(),e.uploaded?t._e():a("div",{staticClass:"progress progress-images"},[a("div",{staticClass:"progress-bar progress-bar-striped bg-success",style:{width:e.progress+"%"},attrs:{role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"}})])])])]),"ZU"===t.objectType?a("div",{staticClass:"row justify-content-center mt-1"},[a("div",{staticClass:"col col-auto"},[e.id in t.files?a("input",{staticClass:"form-control form-control-sm text-center border-0",attrs:{type:"text",placeholder:"Подпись",required:""},domProps:{value:t.files[e.id].caption},on:{input:function(a){return t.$emit("add-caption",e.id,a.target.value)}}}):t._e()])]):t._e()])}):t._e(),"images"===t.type&&t.hasFiles?a("label",{staticClass:"addButton",attrs:{for:"files"+t.type}},[a("i",{staticClass:"fa fa-plus",attrs:{title:t.headers.title}})]):t._e(),"docs"===t.type?a("div",{staticClass:"w-100"},[t._l(t.allFiles,function(e,s){return a("div",{key:s,staticClass:"row pl-3 align-items-center"},[a("div",{staticClass:"col col-auto mt-1"},[a("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"button"},on:{click:function(a){return t.removeFile(e,s)}}},[t._v("\n                  удалить\n              ")])]),a("div",{staticClass:"col col-auto"},[t._v("\n              "+t._s(e.original_filename?e.original_filename:e.filename)+"\n          ")]),a("div",{staticClass:"col col-4"},[e.uploaded?t._e():a("div",{staticClass:"progress"},[a("div",{staticClass:"progress-bar progress-bar-striped bg-success",style:{width:e.progress+"%"},attrs:{role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"}})])])])}),t.hasFiles?a("label",{staticClass:"btn",attrs:{for:"files"+t.type}},[a("span",{staticClass:"btn btn-outline-primary btn-sm",staticStyle:{cursor:"pointer"}},[t._v("\n              Добавить\n          ")])]):t._e()],2):t._e(),a("input",{staticClass:"d-none",attrs:{type:"file",id:"files"+t.type,multiple:""},on:{change:t.addFiles}}),t.hasFiles?t._e():a("label",{staticClass:"addFileDefault",attrs:{for:"files"+t.type}},[t._v("\n    "+t._s(t.headers.default)+"\n  ")])],2)},l=[],d=(a("8e6e"),a("7514"),a("bd86"));a("7f7f"),a("f386");function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,s)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(a,!0).forEach(function(e){Object(d["a"])(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var m={name:"FileUpload",props:["type","files","objectType"],data:function(){return{allFiles:{},mainImage:null}},computed:{imageFolders:function(){return this.$store.state.imageFolders},hasFiles:function(){return Object.keys(this.allFiles).length},headers:function(){return"images"===this.type?{default:"Загрузка изображений",title:"Добавить изображение"}:{default:"Загрузка документов",title:"Добавить документ"}}},mounted:function(){var t=this;Object.keys(this.files).forEach(function(e){var a=JSON.parse(JSON.stringify(t.files[e]));"images"===t.type&&(a.src=t.imageFolders.small+a.filename,a.isMain&&(t.mainImage=a.id)),a.uploaded=!0,t.$set(t.allFiles,a.id,a)})},methods:{addFiles:function(t){var e=this,a=t.target.files;a.length&&(Object.keys(a).forEach(function(t){var s=a[t],o=Math.random().toString(),i={id:o,filename:s.name,fileSrc:s,uploaded:!1,progress:0};if("images"===e.type){if(!s.type.match(/jpeg|gif|bmp|png|jpg/i))return void r["a"].warning("Файл ".concat(s.name," не является изображением"));var n=new FileReader;n.onload=function(){i.src=n.result,e.$set(e.allFiles,o,i),e.upload(i)},n.readAsDataURL(s)}else e.$set(e.allFiles,o,i),e.upload(i)}),t.target.value=null)},upload:function(t){var e=this,a=new FormData,s=t.id;a.append("file",t.fileSrc),a.append("type",this.type),n["b"].post("/files/upload",a,{headers:{"Content-Type":"multipart/form-data"},cancelToken:new n["a"](function(t){e.allFiles[s].cancelUpload=t}),onUploadProgress:function(t){e.allFiles[s].progress=Math.round(100*t.loaded/t.total)}}).then(function(t){e.$emit("uploaded",p({},t.data,{caption:"",isMain:0}),e.type),e.allFiles[s].uploaded=!0,e.allFiles[s].id=t.data.id,"images"!==e.type||e.mainImage||e.makeMain(s)}).catch(function(t){Object(n["c"])(t)||(t.response&&t.response.data.errors?e.errors=t.response.data.errors:r["a"].warning("Что-то пошло не так, обратитесь к разработчикам"))})},removeFile:function(t,e){t.uploaded?this.$emit("removed",t.id,this.type):t.cancelUpload(),this.$delete(this.allFiles,e),this.mainImage&&e===this.mainImage.toString()&&this.makeMain(null)},makeMain:function(t){var e=this,a=Object.keys(this.files),s=t;!t&&a.length&&(s=Object.keys(this.allFiles).find(function(t){return e.allFiles[t].id.toString()===a[0]})),this.mainImage=s;var o=s?this.allFiles[s].id.toString():null;this.$emit("set-main-image",o)}}},b=m,f=(a("871d"),a("2877")),v=Object(f["a"])(b,c,l,!1,null,null,null),h=v.exports,y=["type","address","areaS","groundS","cost","costCurrency","responsible","description","coordinates","location","district","images","docs","only_auth","price_admins_only","object_admins_only"],j=["ZUType","kadastrNumberZU","kadastrNumberOKS","purposeZU","purposeOKS","groundPlan"],g=["GAP","GAPCurrency","caprate","buildingName","buildingType"],_=["areaS","groundS","cost","GAP","caprate"],C={any:y,ZU:j,Invest:g,numericFields:_},w=[{short:"ТЦ",full:"Торговый центр",bg:"primary",icon:"blueDotIcon"},{short:"МФК",full:"Многофункциональный комплекс",bg:"info",icon:"violetDotIcon"},{short:"БЦ",full:"Бизнес-центр",bg:"success",icon:"darkGreenDotIcon"},{short:"ИПН",full:"Инвестиционный портфель недвижимости",bg:"danger",icon:"redDotIcon"},{short:"ГО",full:"Гостиница",bg:"warning",icon:"orangeDotIcon"}],O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:t.style,attrs:{id:"map"}})},k=[],x=a("7618"),S={name:"LKYandexMap",props:["address","object"],data:function(){return{map:null,point:null}},computed:{favoritesOffsetLeft:function(){return this.$store.state.favoritesOffsetLeft},style:function(){return{left:"calc(".concat(this.favoritesOffsetLeft," - 15px)"),width:"calc(100% - ".concat(this.favoritesOffsetLeft," + 15px)")}},isYmapsReady:function(){return this.$store.state.lk.isYmapReady.isReady},coordinates:function(){return this.object.coordinates}},watch:{coordinates:function(t){"object"===Object(x["a"])(t)&&t.length&&this.map&&this.setPoint(t)},address:function(t){var e=this;if(t.length){if(this.object.district.length)if(t.length<3)r["a"].warning("Адрес слишком короткий");else{var a="Москва, ";"MO"===this.object.location&&(a="Московская область, "),ymaps.geocode(a+t,{results:1}).then(function(t){var a=t.geoObjects.get(0),s=a.geometry.getCoordinates();e.$emit("set-coordinates",s),e.setPoint(s)})}else r["a"].warning("Выберите субъект");this.$emit("reset-search-address")}}},mounted:function(){var t=this;this.isYmapsReady?this.init():this.$watch("isYmapsReady",function(e){e&&t.init()})},beforeDestroy:function(){this.map.geoObjects.removeAll(),this.map.destroy()},methods:{init:function(){this.map=new ymaps.Map("map",{center:[55.76141,37.629708],zoom:12,controls:["typeSelector","zoomControl"]}),"object"===Object(x["a"])(this.coordinates)&&this.coordinates.length&&this.setPoint(this.coordinates)},setPoint:function(t){var e=this;this.point?this.point.geometry.setCoordinates(t):(this.point=new ymaps.Placemark(t,{},{preset:"islands#nightDotIcon",cursor:"pointer",draggable:!0}),this.map.geoObjects.add(this.point),this.point.events.add("dragend",function(){var t=e.point.geometry.getCoordinates();e.$emit("set-coordinates",t)}));var a=this.map.getZoom();this.map.setCenter(t,a,{duration:500})}}},$=S,A=(a("2f0f"),Object(f["a"])($,O,k,!1,null,null,null)),N=A.exports,P={name:"LKObject",components:{FileUpload:h,LKYandexMap:N},data:function(){return{object:{},key:Math.random(),objectFields:C,buildingTypes:w,disabled:!1,districts:["Москва, ЦАО","Москва, САО","Москва, СВАО","Москва, ВАО","Москва, ЮВАО","Москва, ЮАО","Москва, ЮЗАО","Москва, СЗАО","Новая Москва и Зеленоград","Московская область"],yandexSearchAddress:""}},mounted:function(){this.init(this.$route.params.id)},beforeRouteUpdate:function(t,e,a){this.object={},this.key=Math.random(),this.init(t.params.id),a()},computed:{favoritesOffsetLeft:function(){return this.$store.state.favoritesOffsetLeft},isNew:function(){return["new","clone"].includes(this.$route.params.id)},head:function(){return this.isNew?"Размещение":"Редактирование"},buttonName:function(){return this.isNew?"Разместить объект":"Сохранить изменения"},allObjectFields:function(){return this.objectFields.any.concat(this.objectFields.ZU,this.objectFields.Invest)}},methods:{init:function(t){if("number"===typeof t||t.match(/\d+/))this.getObject(t);else if("clone"===t){if(!this.$route.params.clone_id)return this.$router.push({name:"lk-objects"});this.getObject(this.$route.params.clone_id)}else this.object=this.checkIfObjectHasAllFields({});return null},getObject:function(t){var e=this;n["b"].get("/objects/".concat(t,"/edit")).then(function(t){var a=t.data,s=Object.assign(a.characteristics,{description:a.description,responsible:a.responsible,only_auth:a.only_auth,price_admins_only:a.price_admins_only,object_admins_only:a.object_admins_only,images:{},docs:{}});"clone"!==e.$route.params.id&&(a.images.forEach(function(t){s.images[t.id]=t}),a.docs.forEach(function(t){s.docs[t.id]=t})),e.object=e.checkIfObjectHasAllFields(s)}).catch(function(){e.$router.push({name:"lk-objects"})})},fileUploaded:function(t,e){i["a"].set(this.object[e],t.id,t)},fileRemoved:function(t,e){if(!this.object[e][t].object_id){var a=this.object[e][t],s=a.id,o=a.filename;n["b"].post("/files/".concat(s),{filename:o},{params:{_method:"DELETE"}}).catch(function(){r["a"].warning("Что пошло не так, перегрузите страницу")})}i["a"].delete(this.object[e],t)},addCaption:function(t,e){this.object.images[t].caption=e},setMainImage:function(t){var e=this;Object.keys(this.object.images).forEach(function(a){e.object.images[a].isMain=t&&a===t?1:0})},saveObject:function(){var t=this;if(Object.keys(this.object.images).length){this.disabled=!0;var e=JSON.parse(JSON.stringify(this.object)),a=this.objectFields.any.concat(this.objectFields[e.type]);Object.keys(e).forEach(function(s){a.includes(s)?t.objectFields.numericFields.includes(s)&&"string"===typeof e[s]&&(e[s]=e[s].replace(/\s/g,"").replace(",",".")):delete e[s]}),"ЗУ"===e.ZUType&&(e.areaS.toString().length||delete e.areaS,e.kadastrNumberOKS.toString().length||delete e.kadastrNumberOKS,e.purposeOKS.toString().length||delete e.purposeOKS);var s={data:e,method:"post"};s.url=this.isNew?"/objects":"/objects/".concat(this.$route.params.id,"?_method=PUT"),n["b"].request(s).then(function(e){if(t.isNew)return t.$router.push({name:"lk-object",params:{id:e.data}}),void r["a"].success("Новый объект добавлен");var a=e.data,s=a.images,o=a.docs;Object.keys(s).forEach(function(e){t.object.images[e].object_id=s[e].object_id,t.object.images[e].filename=s[e].filename}),Object.keys(o).forEach(function(e){t.object.docs[e].object_id=o[e].object_id}),r["a"].success("Изменения сохранены")}).catch(function(t){if(t.response&&t.response.data.errors){var e=Object.values(t.response.data.errors);e.length?r["a"].warning(e[0]):r["a"].warning("Проверьте, все ли поля заполнены верно")}else r["a"].warning("Что-то пошло не так, обратитесь к разработчикам")}).finally(function(){t.disabled=!1})}else r["a"].warning("Добавьте изображение объекта")},checkIfObjectHasAllFields:function(t){var e=t;return this.allObjectFields.forEach(function(a){a in t||(["only_auth","price_admins_only","object_admins_only"].includes(a)?e[a]=!1:["images","docs"].includes(a)?e[a]={}:e[a]="")}),e},setLocation:function(){this.object.district.indexOf("Новая")>=0?this.object.location="New_Moscow":this.object.district.indexOf("область")>=0?this.object.location="MO":""===this.object.district?this.object.location="":this.object.location="Moscow"},setCoordinate:function(t){this.object.coordinates=t},syncScope:function(){this.object.object_admins_only&&(this.object.only_auth=!1,this.object.price_admins_only=!1)}}},F=P,U=(a("43ed"),Object(f["a"])(F,s,o,!1,null,null,null));e["default"]=U.exports}}]);